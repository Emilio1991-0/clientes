package jdbc_connection;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

public class JDBC_ResultSet_actualizable {

	public static void muestraErrorSQL(SQLException e) {
		System.err.println("SQL ERROR mensaje: " + e.getMessage());
		System.err.println("SQL Estado: " + e.getSQLState());
		System.err.println("SQL cÃ³digo especÃ­fico: " + e.getErrorCode());
	}

	public static void main(String[] args) {

		String basedatos = "accesoDatos";
		String host = "localhost";
		String port = "3306";
		String parAdic = "?useUnicode=true&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=UTC";
		String urlConnection = "jdbc:mysql://" + host + ":" + port + "/" + basedatos + parAdic;
		String user = "emilio";
		String pwd = "emilio";

		try (Connection c = DriverManager.getConnection(urlConnection, user, pwd)) {
			try (Statement sConsulta = c.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_UPDATABLE)) {

				// Creo un Scanner
				Scanner sn = new Scanner(System.in);
				sn.useDelimiter("\n");

				// Pido una cadena
				System.out.println("Escribe la fila a mostrar: ");
				String busqueda = sn.next();

				ResultSet rs = sConsulta.executeQuery("SELECT * FROM CLIENTES");
				String DNI = rs.getString("DNI");
				String APELLIDOS = rs.getString("APELLIDOS");
				String CP = rs.getString("CP");

				c.setAutoCommit(false);

				String opcion = "";
				switch (opcion) {
				
				case ".":
					rs.close();
					c.close();

					break;
				case "d":
					
					rs.last();
					System.out.println("");

					break;
				case "k":

					rs.next();

					break;

				}

				c.commit();

			} catch (SQLException e) {
				muestraErrorSQL(e);
				try {
					c.rollback();
					System.err.println("Se hace ROLLBACK");
				} catch (Exception er) {
					System.err.println("ERROR haciendo ROLLBACK");
					er.printStackTrace(System.err);
				}
			}
		} catch (Exception e) {
			System.err.println("ERROR de conexiÃ³n");
			e.printStackTrace(System.err);
		}
	}
}
